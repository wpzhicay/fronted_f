<div class="register-wrapper">
  <div class="register-container">
    <form [formGroup]="registerForm" (ngSubmit)="onRegister()" class="register-form">
      <h2>Crear Cuenta</h2>

      <!-- Foto de perfil (ocupa toda la fila) -->
      <div class="form-group">
        <label for="photo" class="upload-circle">
          <img *ngIf="photoPreview; else placeholder" [src]="photoPreview" alt="Foto de perfil" />
          <ng-template #placeholder><span>+</span></ng-template>
        </label>
        <input id="photo" type="file" accept="image/*" (change)="onFileSelected($event)" hidden />
      </div>

      <!-- Agrupación en dos columnas -->
      <div class="form-columns">
        <div class="form-column">
          <!-- Columna izquierda -->
          <div class="form-group">
            <label for="alias">ID</label>
            <input id="alias" type="text" formControlName="alias" />
            <div *ngIf="registerForm.get('alias')?.touched && registerForm.get('alias')?.invalid">
              <small>El ID es obligatorio.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="name">Nombre Completo</label>
            <input id="name" type="text" formControlName="name" />
            <div *ngIf="registerForm.get('name')?.touched && registerForm.get('name')?.invalid">
              <small *ngIf="registerForm.get('name')?.errors?.['required']">El nombre es obligatorio.</small>
              <small *ngIf="registerForm.get('name')?.errors?.['minlength']">Mínimo 3 caracteres.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="email">Correo Electrónico</label>
            <input id="email" type="email" formControlName="email" />
            <div *ngIf="registerForm.get('email')?.touched && registerForm.get('email')?.invalid">
              <small *ngIf="registerForm.get('email')?.errors?.['required']">El correo es obligatorio.</small>
              <small *ngIf="registerForm.get('email')?.errors?.['email']">Correo inválido.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="phone">Teléfono</label>
            <input id="phone" type="text" formControlName="phone" placeholder="Ej. 0991234567" />
            <div *ngIf="registerForm.get('phone')?.touched && registerForm.get('phone')?.invalid">
              <small *ngIf="registerForm.get('phone')?.errors?.['required']">El teléfono es obligatorio.</small>
              <small *ngIf="registerForm.get('phone')?.errors?.['pattern']">Número inválido. Solo dígitos (7-15).</small>
            </div>
          </div>

          <div class="form-group">
            <label for="country">País</label>
            <input id="country" type="text" formControlName="country" />
            <div *ngIf="registerForm.get('country')?.touched && registerForm.get('country')?.invalid">
              <small>El país es obligatorio.</small>
            </div>
          </div>
        </div>

        <div class="form-column">
          <!-- Columna derecha -->
          <div class="form-group">
            <label for="province">Provincia</label>
            <input id="province" type="text" formControlName="province" />
            <div *ngIf="registerForm.get('province')?.touched && registerForm.get('province')?.invalid">
              <small>La provincia es obligatoria.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="city">Ciudad</label>
            <input id="city" type="text" formControlName="city" />
            <div *ngIf="registerForm.get('city')?.touched && registerForm.get('city')?.invalid">
              <small>La ciudad es obligatoria.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="address">Dirección</label>
            <input id="address" type="text" formControlName="address" />
            <div *ngIf="registerForm.get('address')?.touched && registerForm.get('address')?.invalid">
              <small>La dirección es obligatoria.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="password">Contraseña</label>
            <div class="password-wrapper">
              <input id="password" [type]="showPassword ? 'text' : 'password'" formControlName="password" />
              <button type="button" (click)="togglePasswordVisibility()"></button>
            </div>
            <div *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.invalid">
              <small *ngIf="registerForm.get('password')?.errors?.['required']">La contraseña es obligatoria.</small>
              <small *ngIf="registerForm.get('password')?.errors?.['minlength']">Mínimo 6 caracteres.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Confirmar Contraseña</label>
            <div class="password-wrapper">
              <input id="confirmPassword" [type]="showConfirmPassword ? 'text' : 'password'" formControlName="confirmPassword" />
              <button type="button" (click)="toggleConfirmPasswordVisibility()"></button>
            </div>
            <div *ngIf="registerForm.hasError('passwordMismatch') && registerForm.get('confirmPassword')?.touched">
              <small>Las contraseñas no coinciden.</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Términos y botón (fuera de columnas) -->
      <div class="form-group">
        <label>
          <input type="checkbox" formControlName="terms" />
          Acepto los términos y condiciones
        </label>
        <div *ngIf="registerForm.get('terms')?.touched && registerForm.get('terms')?.invalid">
          <small>Debes aceptar los términos.</small>
        </div>
      </div>

      <button type="submit" [disabled]="registerForm.invalid">Registrarse</button>
    </form>
  </div>
</div>
